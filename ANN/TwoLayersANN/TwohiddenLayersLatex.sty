## Latex Expressions
X_{1}=[1,2,3]\\
X_{2}=[3,4,5]\\
Y =[5.85,7.6,10.25] \\
Y= 0.25  \times X_{1}^{2}+0.2 \times X_{1 }\times X_{2} + 5

After\ normalisation\ of\ data\ using\ the\ following\ expresssions:\\
X_{normalised} = (X - X_{min})/(X_{max} - X_{min})\\ 
Y_{normalised}=(Y - Ymin)/(Y_{max}-Y_{min})\\

X_{1} = [0. , 0.5, 1.] \\
X_{2} = [0. , 0.5, 1.] \\
Y = [ 0., 0.397, 1.]\\

From\ X_{1}\ and\ X_{2}\ to\ the\ first\ hidden\ layer:\\

\omega_{11}, \omega_{21}, \omega_{12}, \omega_{22} \\
-0.251,  0.901, 0.464,  0.197\\
From\ the\ first\ hidden\ layer \ to\ the\ second\ hidden\ layer:\\

\omega_{31}, \omega_{41}, \omega_{32}, \omega_{42}\\
-0.688, -0.688, -0.884,  0.732\\

From\ the \ second \ hidden \ layer\ to\ the\ Output\ layer \ Y_{pred}:\\
 \omega_{51}, \omega_{52} \\
0.202,0.416,
\\

Bias :\\
b_{1}, b_{2}, b_{3}, b_{4}\\
-0.959,  0.940,   0.665, -0.575


Learning\ rate\ \alpha = 0.1\\
Activation\ function : Sigmoid\ function\:\\
\sigma(Z) = 1/(1+e^{-Z})




From\ X_{1}\ and\ X_{2}\ to\ the\ first\ hidden\ layer:\\
Left\ side\ of\ the\ first\ hidden\ layer:\\
Z_{11} = \omega_{11}\times\ X_{1}+ \omega_{12}\times\ X_{2} + b_{1} \\
Z_{12} = \omega_{21}\times\ X_{1}+ \omega_{22}\times\ X_{2} + b_{2}\\

Right\ side\ of\ the\ first\ hidden\ layer\ after\ activation\ of\ neurons :\\

A_{11}=\sigma(Z_{11})\\
A_{12}= \sigma(Z_{12})\\
\\
Left\ side\ of\ the\ second\ hidden\ layer\ using\ A_{11 }\ and\ A_{12}\ as\ inputs\ to\ the\ two\ neurons :\\

Z_{21}=A_{11} \times \omega_{31}+A_{12} \times \omega_{32}+b_{3}\\
Z_{22}=A_{11} \times \omega_{41}+A_{12} \times \omega_{42}+b_{4}\\
Right\ side\ of\ the\ second\ hidden\ layer\ after\ activation\ of\ neurons :\\
A_{21} = \sigma(Z_{21})\\
    A_{22} = \sigma(Z_{22})\\
\\
Output:\\
Y_{pred} = A_{21} \times w_{51} + A_{22} \times w_{52}\\



From\ X_{1}\ and\ X_{2}\ to\ the\ first\ hidden\ layer:\\
X_{1} = [0. , 0.5, 1.] \\
X_{2} = [0. , 0.5, 1.] \\
\omega_{11}, \omega_{21}, \omega_{12}, \omega_{22} \\
-0.251,  0.901, 0.464,  0.197\\
b_{1}, b_{2}, b_{3}, b_{4}\\
-0.959,  0.940,   0.665, -0.575\\
Z_{11} = \omega_{11}\times\ X_{1}+ \omega_{12}\times\ X_{2} + b_{1} \\
\\ For\ each \ value\ of\ X_{1}\ and \ X_{2}:\\
Z_{11}=-0.251*0.0+0.464*0.0-0.959=-0.959\\
Z_{11}=-0.251*0.5+0.464*0.5-0.959=-0.853\\
Z_{11}=-0.251*1+0.464*1-0.959=-0.746\\


Z_{12} = \omega_{21}\times\ X_{1}+ \omega_{22}\times\ X_{2} + b_{2}\\
Z_{12}=0.901*0.0+0.197*0.0+0.940=0.940\\
Z_{12}=0.901*0.5+0.197*0.5+0.940=1.489\\
Z_{12}=0.901*1+0.197*1+0.940=2.038\\
A_{11}=\sigma(Z_{11})\\
A_{11}=1/(1+e{^{(-0.9409)}})=0.277\\
A_{11}=1/(1+e{^{(-1.489)}})=0.299\\
A_{11}=1/(1+e{^{(-2.038)}})=0.322\\

A_{12}= \sigma(Z_{12})\\

A_{12}=1/(1+e^{(0.959)})=0.719\\
A_{12}=1/(1+e^{(0.853)})=0.816\\
A_{12}=1/(1+e^{(0.746)})=0.885\\



Z_{21} = \omega_{31}\times\ A_{11}+ \omega_{32}\times\ A_{12} + b_{3}\\
Z_{22} = \omega_{41}\times\ A_{11}+ \omega_{42}\times\ A_{12} + b_{4}\\
\omega_{31}, \omega_{41}, \omega_{32}, \omega_{42}\\
-0.688, -0.688, -0.884,  0.732\\
b_{3}, b_{4}\\
0.665, -0.575\\
Z_{21}=-0.688*0.277-0.884*0.719+0.665=-0.161\\
Z_{21}=-0.688*0.299-0.884*0.816+0.665=-0.262\\
Z_{21}=-0.688*0.322-0.884*0.885+0.665=-0.338\\

Z_{22}=-0.688*0.277+0.732*0.719-0.575=-0.239\\
Z_{22}=-0.688*0.299+0.732*0.816-0.575=-0.183\\
Z_{22}=-0.688*0.322+0.732*0.885-0.575=-0.148\\


A_{21} = \sigma(Z_{21})\\
A_{21}=1/(1+e{^{(0.161)}})=0.460\\
A_{21}=1/(1+e{^{(0.262)}})=0.435\\
A_{21}=1/(1+e{^{(0.335)}})=0.416\\
A_{22} = \sigma(Z_{22})\\
A_{22}=1/(1+e{^{(0.239)}})=0.440\\
A_{22}=1/(1+e{^{(0.183)}})=0.454\\
A_{22}=1/(1+e{^{(0.148)}})=0.463\\



Output:\\
Y_{pred} = A_{21} \times w_{51} + A_{22} \times w_{52}\\
 \omega_{51}, \omega_{52} \\
0.202,0.416\\

Y_{pred_1}=0.202*0.460+0.416*0.440=0.276\\
Y_{pred_2}=0.202*0.435+0.416*0.454=0.277\\
Y_{pred_3}=0.202*0.416+0.416*0.463=0.277\\



MSE = (1/2n) \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}})^{2} :\\

MSE =(1/ (2 \times 3))\times[((Y_{\text{pred}_1}-Y_{\text{true}_1})^{2})+((Y_{\text{pred}_2}-Y_{\text{true}_2})^{2})+((Y_{\text{pred}_3}-Y_{\text{true}_3})^{2})]\\
1/6 \times [(0-0.276)^{2}+(0.397-0.277)^{2}+(1-0.277)^{2})]=0.1022

For\ \omega_{51} : ∂MSE/∂\omega_{51} = (∂MSE/∂Y_{\text{pred}}) \times (∂Y_{\text{pred}}/∂\omega_{51})  \\
or\ (∂MSE/∂Y_{\text{pred}}) = ∂[(1/2n) \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}})^{2}]/∂Y_{\text{pred}} = (1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}})\\

We\ can \ derive\ the \ mathematical \ expressions\ of :\\
∂MSE/∂\omega_{51} = (1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times (∂Y_{\text{pred}}/∂\omega_{51}) =\\(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times\ ∂(A_{21} \times w_{51} + A_{22} \times w_{52})/∂\omega_{51}=
 \\(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times\ A_{21}\\
\\
In\ the\ same \ way:\\
For\ \omega_{52} : ∂MSE/∂\omega_{52} =(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times\ A_{22}\\
\\
 ∂MSE/∂\omega_{51} =(1/3)\times ((0.276-0)\times 0.460+(0.277-0.397)\times 0.435+(0.277-1)\times0.416)=-0.075 \\
 ∂MSE/∂\omega_{52} =(1/3)\times ((0.276-0)\times 0.44+(0.277-0.397)\times 0.454+(0.277-1)\times0.463)=-0.089 \\
 \\
 

 
 ∂MSE/∂\omega_{31}=∂MSE/∂Y_{pred} \times ∂Y_{pred}/∂A_{21} \times ∂A_{21}/∂Z_{21} \times ∂Z_{21}/∂\omega_{31}\\
 ∂MSE/∂\omega_{32}=∂MSE/∂Y_{pred} \times ∂Y_{pred}/∂A_{21} \times ∂A_{21}/∂Z_{21} \times ∂Z_{21}/∂\omega_{32}\\
 
 ∂MSE/∂Y_{pred}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}})\\
 
 ∂Y_{pred}/∂A_{21}=∂(A_{21} \times w_{51} + A_{22} \times w_{52})/∂A_{21}=w_{51}\\
 ∂A_{21}/∂Z_{21}=∂\sigma(Z_{21})/∂Z_{21}=\sigma(Z_{21})\times (1-\sigma(Z_{21}))\\
 ∂Z_{21}/∂\omega_{31}=∂(A_{11} \times \omega_{31}+A_{12} \times \omega_{32}+b_{3})/∂\omega_{31}=A_{11}\\
 
 ∂MSE/∂\omega_{31}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times w_{51} \times A_{11} \times \sigma(Z_{21})\times (1-\sigma(Z_{21})) \\
 
 ∂MSE/∂\omega_{32}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times w_{52} \times A_{12} \times \sigma(Z_{21})\times (1-\sigma(Z_{21})\\
 
 
 ∂MSE/∂\omega_{31}=(1/3) \times [((0.276-0)\times 0.202 \times 0.277 \times 0.460\times(1-0.460))+...\\(((0.277-0.397)\times0.202 \times0.299\times 0.435 \times(1-0.435))+...\\
 ((0.277-1)\times0.202\times0.322 \times0.416 \times(1-0.416))]=-0.003\\
 ∂MSE/∂\omega_{32}=-0.009\\
 \\
 
 ∂MSE/∂\omega_{41}=∂MSE/∂Y_{pred} \times ∂Y_{pred}/∂A_{22} \times ∂A_{22}/∂Z_{22} \times ∂Z_{22}/∂\omega_{41}\\
 ∂MSE/∂\omega_{42}=∂MSE/∂Y_{pred} \times ∂Y_{pred}/∂A_{22} \times ∂A_{22}/∂Z_{22} \times ∂Z_{22}/∂\omega_{42}\\
 
 ∂MSE/∂Y_{pred}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}})\\
 ∂Y_{pred}/∂A_{22}=∂(A_{21} \times w_{51} + A_{22} \times w_{52})/∂A_{22}=w_{52}\\
 ∂A_{22}/∂Z_{22}=∂\sigma(Z_{22})/∂Z_{22}=\sigma(Z_{22})\times (1-\sigma(Z_{22}))\\
 ∂Z_{22}/∂\omega_{41}=∂(A_{11} \times \omega_{41}+A_{12} \times \omega_{42}+b_{4})/∂\omega_{41}=A_{11}\\
 
 ∂MSE/∂\omega_{41}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times w_{52} \times A_{11} \times \sigma(Z_{22})\times (1-\sigma(Z_{22})) \\
 ∂MSE/∂\omega_{42}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times w_{52} \times A_{12} \times \sigma(Z_{22})\times (1-\sigma(Z_{22})\\(
 
 
 
 ∂MSE/∂\omega_{41}=(1/3) \times [((0.276-0)\times0.416\times0.277\times0.44\times(1-0.44))+...\\((0.276-0.397)\times0.42\times0.299 \times0.454\times(1-0.454))+...\\
 ((0.276-1)\times0.42\times0.322 \times0.463\times(1-0.463))]=-0.007\\
 
 ∂MSE/∂\omega_{42}=-0.018 \\
 
 

 

 
 ∂MSE/∂\omega_{11}=∂MSE/∂Y_{pred} \times ∂Y_{pred}/∂A_{21} \times ∂A_{21}/∂Z_{21} \times ∂Z_{21}/∂A_{11} \times ∂A_{11}/∂Z_{11} \times ∂Z_{11}/∂w_{11}\\

 ∂MSE/∂\omega_{12}=∂MSE/∂Y_{pred} \times ∂Y_{pred}/∂A_{21} \times ∂A_{21}/∂Z_{21} \times ∂Z_{21}/∂A_{11} \times ∂A_{11}/∂Z_{11} \times ∂Z_{11}/∂w_{12}\\
 
 
 
 ∂MSE/∂\omega_{21}=∂MSE/∂Y_{pred} \times ∂Y_{pred}/∂A_{22} \times ∂A_{22}/∂Z_{22} \times ∂Z_{22}/∂A_{12} \times ∂A_{12}/∂Z_{12} \times ∂Z_{12}/∂w_{21}\\
 
 
 ∂MSE/∂\omega_{22}=∂MSE/∂Y_{pred} \times ∂Y_{pred}/∂A_{22} \times ∂A_{22}/∂Z_{22} \times ∂Z_{22}/∂A_{12} \times ∂A_{12}/∂Z_{12} \times ∂Z_{12}/∂w_{22}\\
 
  ∂MSE/∂\omega_{11}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times w_{51} \times \ 
 \sigma(Z_{21})\times (1-\sigma(Z_{21})) \times \omega_{31} \times \sigma(Z_{11})\times (1- \sigma(Z_{11})) \times X_{1} \\
 
  ∂MSE/∂\omega_{12}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times w_{51} \times \ 
 \sigma(Z_{21})\times (1-\sigma(Z_{21})) \times \omega_{31} \times \sigma(Z_{11})\times (1- \sigma(Z_{11})) \times X_{2} \\

∂MSE/∂\omega_{11}=(1/3) \times [(0.276-0) \times0.202 \times0.46\times (1-0.46) \times -0.688 \times0.277 \times (1-0.277)\times 0 +...\\
(0.277-0.397) \times0.202 \times0.435\times (1-0.435) \times -0.688 \times0.299 \times (1-0.299)\times 0.5 +...\\
(0.276-01) \times0.202 \times0.416\times (1-0.416) \times -0.688 \times0.322 \times (1-0.322)\times 1]=0.0019\\ 
In\ the\ same\ way:\\
∂MSE/∂\omega_{12}=0.0019

 
 
  ∂MSE/∂b_{1}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times w_{51} \times \ 
 \sigma(Z_{21})\times (1-\sigma(Z_{21})) \times \omega_{31} \times \sigma(Z_{11})\times (1- \sigma(Z_{11})) \times 1 \\
 
  ∂MSE/∂b_{2}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times w_{51} \times \ 
 \sigma(Z_{21})\times (1-\sigma(Z_{21})) \times \omega_{31} \times \sigma(Z_{11})\times (1- \sigma(Z_{11})) \times 1 \\
 
  ∂MSE/∂b_{3}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times w_{51} \times \ 
 \sigma(Z_{21})\times (1-\sigma(Z_{21})) \times 1 \\
 
  ∂MSE/∂b_{4}=(1/n) \times \sum_{1}^{n}(Y_{\text{pred}}-Y_{\text{true}}) \times w_{52} \times \ 
 \sigma(Z_{22})\times (1-\sigma(Z_{22})) \times 1 \\
 
 
 
 